import csv
import random
from datetime import datetime, timedelta

# Данные для генерации
addresses = [
    "ул. Ленина 12",
    "ул. Советская 7",
    "ул. Пушкина 34",
    "ул. Гагарина 10",
    "ул. Победы 5",
    "ул. Жукова 25",
    "ул. Кирова 18",
    "ул. Чехова 6",
    "ул. Мира 40",
    "ул. Строителей 3",
    "ул. Школьная 22",
    "ул. Рабочая 17",
    "ул. Новая 9",
    "ул. Центральная 15",
    "ул. Зеленая 13",
    "ул. Молодежная 11",
    "ул. Березовая 4",
    "ул. Садовая 27",
    "ул. Полевая 19",
    "ул. Северная 21",
    "ул. Южная 23",
    "ул. Восточная 29",
    "ул. Западная 8",
    "ул. Луговая 2",
    "ул. Парковая 16",
    "ул. Колхозная 14",
    "ул. Заводская 30",
    "ул. Набережная 28",
    "ул. Октябрьская 24",
    "ул. Первомайская 1"
]


names = [
    "Иванов Иван Иванович",
    "Петров Пётр Петрович",
    "Сидоров Алексей Николаевич",
    "Кузнецова Мария Сергеевна",
    "Смирнова Анна Владимировна",
    "Попов Михаил Андреевич",
    "Васильева Ольга Алексеевна",
    "Морозов Дмитрий Юрьевич",
    "Новикова Елена Павловна",
    "Фёдоров Артём Викторович",
    "Соколова Наталья Романовна",
    "Лебедев Максим Евгеньевич",
    "Козлова Дарья Михайловна",
    "Алексеева Татьяна Олеговна",
    "Зайцев Игорь Никитич",
    "Мельников Павел Аркадьевич",
    "Николаева Светлана Валерьевна",
    "Орлова Екатерина Степановна",
    "Борисов Андрей Сергеевич",
    "Комарова Виктория Артемьевна",
    "Григорьев Олег Дмитриевич",
    "Тимофеева Алина Юрьевна",
    "Егоров Константин Ильич",
    "Макарова Инна Геннадьевна",
    "Семенов Роман Витальевич",
    "Антонова Людмила Николаевна",
    "Михайлов Станислав Игоревич",
    "Белова Надежда Тимофеевна",
    "Тихонов Евгений Владимирович",
    "Киселёва Полина Васильевна"
]


# Функция генерации записи
def generate_record(id, start_date):
    start_time = datetime.combine(start_date, datetime.min.time()) + timedelta(
        hours=random.randint(8, 16),
        minutes=random.choice([0, 10, 20, 30, 40, 50])
    )
    duration = timedelta(minutes=random.randint(60, 120))
    end_time = start_time + duration
    address = random.choice(addresses)
    name = random.choice(names)
    return [id, start_time.strftime("%Y-%m-%d %H:%M:%S"), end_time.strftime("%Y-%m-%d %H:%M:%S"), address, name]

# Генерация CSV
def generate_csv(filename, start_id=256, count=300, start_date_str="2025-06-01"):
    start_date = datetime.strptime(start_date_str, "%Y-%m-%d").date()
    with open(filename, mode='w', newline='', encoding='utf-8') as file:
        writer = csv.writer(file)
        for i in range(count):
            record_date = start_date + timedelta(days=i)
            record = generate_record(start_id + i, record_date)
            writer.writerow(record)

# Вызов функции генерации
generate_csv("orders_test.csv", count=300)
